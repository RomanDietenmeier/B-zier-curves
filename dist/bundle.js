/******/ (() => { // webpackBootstrap
var __webpack_exports__ = {};
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
//https://en.wikipedia.org/wiki/B%C3%A9zier_curve#Constructing_B%C3%A9zier_curves
(function () {
    var canvas = document.createElement("canvas");
    var width = 640;
    var height = 640;
    canvas.width = width;
    canvas.height = height;
    var canvasContext = canvas.getContext("2d");
    document.body.append(canvas);
    function drawClearRect() {
        canvasContext.beginPath();
        canvasContext.rect(0, 0, width, height);
        canvasContext.fillStyle = "#eee";
        canvasContext.fill();
        canvasContext.fillStyle = "#000";
        canvasContext.font = "20px Consolas";
        canvasContext.fillText(" Left Click: Set Point", 1, 20);
        canvasContext.fillText("Right Click: Confirm", 1, 40);
        canvasContext.fillText("BÃ©zier curves", width - 150, 20);
    }
    drawClearRect();
    var bezierPoints = [];
    function drawDot(x, y, color, radius) {
        if (radius === void 0) { radius = 1; }
        canvasContext.beginPath();
        canvasContext.arc(x, y, Math.max(1, radius), 0, 2 * Math.PI);
        canvasContext.fillStyle = color !== null && color !== void 0 ? color : "#000";
        canvasContext.fill();
    }
    function addBezierPointAndDraw(x, y) {
        if (bezierPoints.length < 1)
            drawClearRect();
        bezierPoints.push({ x: x, y: y });
        drawDot(x, y, "red", 3);
    }
    function factorial(n) {
        if (n < 1)
            return 1;
        var ret = 1;
        for (var i = Math.floor(n); i > 1; i--) {
            ret *= i;
        }
        return ret;
    }
    function binomialCoefficient(n, k) {
        console.assert(k <= n && k >= 0, "illegal binomialCoefficient ".concat(n, " over ").concat(k));
        return factorial(n) / (factorial(k) * factorial(n - k));
    }
    function multScalarWithPoint(p, s) {
        return { x: p.x * s, y: p.y * s };
    }
    function addTwoPoints(lhs, rhs) {
        return { x: lhs.x + rhs.x, y: lhs.y + rhs.y };
    }
    function calcBezierY(t) {
        console.assert(t >= 0 && t <= 1, "t out of bounds");
        var erg = { x: 0, y: 0 };
        for (var i = 0; i < bezierPoints.length; i++) {
            var p = multScalarWithPoint(bezierPoints[i], binomialCoefficient(bezierPoints.length - 1, i) *
                Math.pow(1 - t, bezierPoints.length - 1 - i) *
                Math.pow(t, i));
            console.log("p ".concat(i, ":"), Math.pow(t, i), Math.pow(1 - t, bezierPoints.length - i), binomialCoefficient(bezierPoints.length, i));
            erg = addTwoPoints(p, erg);
        }
        return erg;
    }
    function onClick(clickEvent) {
        clickEvent.preventDefault();
        var x = clickEvent.clientX - canvas.offsetLeft;
        var y = clickEvent.clientY - canvas.offsetTop;
        console.log(clickEvent);
        addBezierPointAndDraw(x, y);
    }
    function onConfirm(contextMenuEvent) {
        contextMenuEvent.preventDefault();
        if (bezierPoints.length < 2)
            return;
        for (var t = 0; t <= 1; t += 0.007) {
            var point = calcBezierY(t);
            drawDot(point.x, point.y);
        }
        console.log(bezierPoints.slice());
        bezierPoints.splice(0); //clear Array
    }
    canvas.addEventListener("click", onClick);
    canvas.addEventListener("contextmenu", onConfirm);
    var buttonConfirm = document.createElement("button");
    buttonConfirm.innerText = "Confirm";
    buttonConfirm.onclick = onConfirm;
    document.body.append(document.createElement("br"));
    document.body.append(buttonConfirm);
})();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFDLENBQUM7WUFFN0IsT0FBTyxDQUFDLEtBQUssQ0FBQyxDQUFDLEVBQUUsS0FBSyxDQUFDLENBQUMsQ0FBQyxDQUFDO1NBQzNCO1FBQ0QsT0FBTyxDQUFDLEdBQUcsQ0FBQyxZQUFZLENBQUMsS0FBSyxFQUFFLENBQUMsQ0FBQztRQUVsQyxZQUFZLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsYUFBYTtJQUN2QyxDQUFDO0lBRUQsTUFBTSxDQUFDLGdCQUFnQixDQUFDLE9BQU8sRUFBRSxPQUFPLENBQUMsQ0FBQztJQUMxQyxNQUFNLENBQUMsZ0JBQWdCLENBQUMsYUFBYSxFQUFFLFNBQVMsQ0FBQyxDQUFDO0lBQ2xELElBQU0sYUFBYSxHQUFHLFFBQVEsQ0FBQyxhQUFhLENBQUMsUUFBUSxDQUFDLENBQUM7SUFDdkQsYUFBYSxDQUFDLFNBQVMsR0FBRyxTQUFTLENBQUM7SUFDcEMsYUFBYSxDQUFDLE9BQU8sR0FBRyxTQUFTLENBQUM7SUFDbEMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ25ELFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBQ3RDLENBQUMsQ0FBQyxFQUFFLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iZXppZXItY3VydmUvLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy9odHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9CJUMzJUE5emllcl9jdXJ2ZSNDb25zdHJ1Y3RpbmdfQiVDMyVBOXppZXJfY3VydmVzXHJcblxyXG4oKCkgPT4ge1xyXG4gIGxldCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gIGNvbnN0IHdpZHRoID0gNjQwO1xyXG4gIGNvbnN0IGhlaWdodCA9IDY0MDtcclxuXHJcbiAgY2FudmFzLndpZHRoID0gd2lkdGg7XHJcbiAgY2FudmFzLmhlaWdodCA9IGhlaWdodDtcclxuICBjb25zdCBjYW52YXNDb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICBkb2N1bWVudC5ib2R5LmFwcGVuZChjYW52YXMpO1xyXG5cclxuICBmdW5jdGlvbiBkcmF3Q2xlYXJSZWN0KCk6IHZvaWQge1xyXG4gICAgY2FudmFzQ29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgIGNhbnZhc0NvbnRleHQucmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgIGNhbnZhc0NvbnRleHQuZmlsbFN0eWxlID0gXCIjZWVlXCI7XHJcbiAgICBjYW52YXNDb250ZXh0LmZpbGwoKTtcclxuICAgIGNhbnZhc0NvbnRleHQuZmlsbFN0eWxlID0gXCIjMDAwXCI7XHJcbiAgICBjYW52YXNDb250ZXh0LmZvbnQgPSBcIjIwcHggQ29uc29sYXNcIjtcclxuICAgIGNhbnZhc0NvbnRleHQuZmlsbFRleHQoXCIgTGVmdCBDbGljazogU2V0IFBvaW50XCIsIDEsIDIwKTtcclxuICAgIGNhbnZhc0NvbnRleHQuZmlsbFRleHQoXCJSaWdodCBDbGljazogQ29uZmlybVwiLCAxLCA0MCk7XHJcbiAgICBjYW52YXNDb250ZXh0LmZpbGxUZXh0KFwiQsOpemllciBjdXJ2ZXNcIiwgd2lkdGggLSAxNTAsIDIwKTtcclxuICB9XHJcbiAgZHJhd0NsZWFyUmVjdCgpO1xyXG5cclxuICB0eXBlIFBvaW50ID0geyB4OiBudW1iZXI7IHk6IG51bWJlciB9O1xyXG4gIGNvbnN0IGJlemllclBvaW50czogQXJyYXk8UG9pbnQ+ID0gW107XHJcblxyXG4gIGZ1bmN0aW9uIGRyYXdEb3QoeDogbnVtYmVyLCB5OiBudW1iZXIsIGNvbG9yPzogc3RyaW5nLCByYWRpdXMgPSAxKTogdm9pZCB7XHJcbiAgICBjYW52YXNDb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgY2FudmFzQ29udGV4dC5hcmMoeCwgeSwgTWF0aC5tYXgoMSwgcmFkaXVzKSwgMCwgMiAqIE1hdGguUEkpO1xyXG4gICAgY2FudmFzQ29udGV4dC5maWxsU3R5bGUgPSBjb2xvciA/PyBcIiMwMDBcIjtcclxuICAgIGNhbnZhc0NvbnRleHQuZmlsbCgpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gYWRkQmV6aWVyUG9pbnRBbmREcmF3KHg6IG51bWJlciwgeTogbnVtYmVyKTogdm9pZCB7XHJcbiAgICBpZiAoYmV6aWVyUG9pbnRzLmxlbmd0aCA8IDEpIGRyYXdDbGVhclJlY3QoKTtcclxuICAgIGJlemllclBvaW50cy5wdXNoKHsgeCwgeSB9KTtcclxuICAgIGRyYXdEb3QoeCwgeSwgXCJyZWRcIiwgMyk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBmYWN0b3JpYWwobjogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgIGlmIChuIDwgMSkgcmV0dXJuIDE7XHJcbiAgICBsZXQgcmV0ID0gMTtcclxuICAgIGZvciAobGV0IGkgPSBNYXRoLmZsb29yKG4pOyBpID4gMTsgaS0tKSB7XHJcbiAgICAgIHJldCAqPSBpO1xyXG4gICAgfVxyXG4gICAgcmV0dXJuIHJldDtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGJpbm9taWFsQ29lZmZpY2llbnQobjogbnVtYmVyLCBrOiBudW1iZXIpOiBudW1iZXIge1xyXG4gICAgY29uc29sZS5hc3NlcnQoXHJcbiAgICAgIGsgPD0gbiAmJiBrID49IDAsXHJcbiAgICAgIGBpbGxlZ2FsIGJpbm9taWFsQ29lZmZpY2llbnQgJHtufSBvdmVyICR7a31gXHJcbiAgICApO1xyXG4gICAgcmV0dXJuIGZhY3RvcmlhbChuKSAvIChmYWN0b3JpYWwoaykgKiBmYWN0b3JpYWwobiAtIGspKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIG11bHRTY2FsYXJXaXRoUG9pbnQocDogUG9pbnQsIHM6IG51bWJlcik6IFBvaW50IHtcclxuICAgIHJldHVybiB7IHg6IHAueCAqIHMsIHk6IHAueSAqIHMgfTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGFkZFR3b1BvaW50cyhsaHM6IFBvaW50LCByaHM6IFBvaW50KTogUG9pbnQge1xyXG4gICAgcmV0dXJuIHsgeDogbGhzLnggKyByaHMueCwgeTogbGhzLnkgKyByaHMueSB9O1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gY2FsY0JlemllclkodDogbnVtYmVyKTogUG9pbnQge1xyXG4gICAgY29uc29sZS5hc3NlcnQodCA+PSAwICYmIHQgPD0gMSwgXCJ0IG91dCBvZiBib3VuZHNcIik7XHJcbiAgICBsZXQgZXJnOiBQb2ludCA9IHsgeDogMCwgeTogMCB9O1xyXG4gICAgZm9yIChsZXQgaSA9IDA7IGkgPCBiZXppZXJQb2ludHMubGVuZ3RoOyBpKyspIHtcclxuICAgICAgY29uc3QgcCA9IG11bHRTY2FsYXJXaXRoUG9pbnQoXHJcbiAgICAgICAgYmV6aWVyUG9pbnRzW2ldLFxyXG4gICAgICAgIGJpbm9taWFsQ29lZmZpY2llbnQoYmV6aWVyUG9pbnRzLmxlbmd0aCAtIDEsIGkpICpcclxuICAgICAgICAgIE1hdGgucG93KDEgLSB0LCBiZXppZXJQb2ludHMubGVuZ3RoIC0gMSAtIGkpICpcclxuICAgICAgICAgIE1hdGgucG93KHQsIGkpXHJcbiAgICAgICk7XHJcbiAgICAgIGNvbnNvbGUubG9nKFxyXG4gICAgICAgIGBwICR7aX06YCxcclxuICAgICAgICBNYXRoLnBvdyh0LCBpKSxcclxuICAgICAgICBNYXRoLnBvdygxIC0gdCwgYmV6aWVyUG9pbnRzLmxlbmd0aCAtIGkpLFxyXG4gICAgICAgIGJpbm9taWFsQ29lZmZpY2llbnQoYmV6aWVyUG9pbnRzLmxlbmd0aCwgaSlcclxuICAgICAgKTtcclxuICAgICAgZXJnID0gYWRkVHdvUG9pbnRzKHAsIGVyZyk7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIGVyZztcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIG9uQ2xpY2soY2xpY2tFdmVudDogTW91c2VFdmVudCk6IHZvaWQge1xyXG4gICAgY2xpY2tFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgY29uc3QgeCA9IGNsaWNrRXZlbnQuY2xpZW50WCAtIGNhbnZhcy5vZmZzZXRMZWZ0O1xyXG4gICAgY29uc3QgeSA9IGNsaWNrRXZlbnQuY2xpZW50WSAtIGNhbnZhcy5vZmZzZXRUb3A7XHJcbiAgICBjb25zb2xlLmxvZyhjbGlja0V2ZW50KTtcclxuXHJcbiAgICBhZGRCZXppZXJQb2ludEFuZERyYXcoeCwgeSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBvbkNvbmZpcm0oY29udGV4dE1lbnVFdmVudDogTW91c2VFdmVudCk6IHZvaWQge1xyXG4gICAgY29udGV4dE1lbnVFdmVudC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgaWYgKGJlemllclBvaW50cy5sZW5ndGggPCAyKSByZXR1cm47XHJcbiAgICBmb3IgKGxldCB0ID0gMDsgdCA8PSAxOyB0ICs9IDAuMDA3KSB7XHJcbiAgICAgIGNvbnN0IHBvaW50ID0gY2FsY0JlemllclkodCk7XHJcblxyXG4gICAgICBkcmF3RG90KHBvaW50LngsIHBvaW50LnkpO1xyXG4gICAgfVxyXG4gICAgY29uc29sZS5sb2coYmV6aWVyUG9pbnRzLnNsaWNlKCkpO1xyXG5cclxuICAgIGJlemllclBvaW50cy5zcGxpY2UoMCk7IC8vY2xlYXIgQXJyYXlcclxuICB9XHJcblxyXG4gIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25DbGljayk7XHJcbiAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBvbkNvbmZpcm0pO1xyXG4gIGNvbnN0IGJ1dHRvbkNvbmZpcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gIGJ1dHRvbkNvbmZpcm0uaW5uZXJUZXh0ID0gXCJDb25maXJtXCI7XHJcbiAgYnV0dG9uQ29uZmlybS5vbmNsaWNrID0gb25Db25maXJtO1xyXG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJiclwiKSk7XHJcbiAgZG9jdW1lbnQuYm9keS5hcHBlbmQoYnV0dG9uQ29uZmlybSk7XHJcbn0pKCk7XHJcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==