/******/ (() => { // webpackBootstrap
var __webpack_exports__ = {};
/*!**********************!*\
  !*** ./src/index.ts ***!
  \**********************/
//https://en.wikipedia.org/wiki/B%C3%A9zier_curve#Constructing_B%C3%A9zier_curves
(function () {
    var canvas = document.createElement("canvas");
    var width = 640;
    var height = 640;
    canvas.width = width;
    canvas.height = height;
    var canvasContext = canvas.getContext("2d");
    document.body.append(canvas);
    function drawClearRect() {
        canvasContext.beginPath();
        canvasContext.rect(0, 0, width, height);
        canvasContext.fillStyle = "#eee";
        canvasContext.fill();
        canvasContext.fillStyle = "#000";
        canvasContext.font = "20px Consolas";
        canvasContext.fillText(" Left Click: Set Point", 1, 20);
        canvasContext.fillText("Right Click: Confirm", 1, 40);
        canvasContext.fillText("BÃ©zier curves", width - 150, 20);
    }
    drawClearRect();
    var bezierPoints = [];
    function drawDot(x, y, color, radius) {
        if (radius === void 0) { radius = 1; }
        canvasContext.beginPath();
        canvasContext.arc(x, y, Math.max(1, radius), 0, 2 * Math.PI);
        canvasContext.fillStyle = color !== null && color !== void 0 ? color : "#000";
        canvasContext.fill();
    }
    function drawLineBetweenPoints(lhs, rhs, color) {
        canvasContext.beginPath();
        canvasContext.moveTo(lhs.x, lhs.y);
        canvasContext.lineTo(rhs.x, rhs.y);
        canvasContext.strokeStyle = color !== null && color !== void 0 ? color : "#000";
        canvasContext.closePath();
        canvasContext.stroke();
    }
    function addBezierPointAndDraw(x, y) {
        if (bezierPoints.length < 1)
            drawClearRect();
        bezierPoints.push({ x: x, y: y });
        drawDot(x, y, "red", 3);
    }
    function factorial(n) {
        if (n < 1)
            return 1;
        var ret = 1;
        for (var i = Math.floor(n); i > 1; i--) {
            ret *= i;
        }
        return ret;
    }
    function binomialCoefficient(n, k) {
        console.assert(k <= n && k >= 0, "illegal binomialCoefficient ".concat(n, " over ").concat(k));
        return factorial(n) / (factorial(k) * factorial(n - k));
    }
    function multScalarWithPoint(p, s) {
        return { x: p.x * s, y: p.y * s };
    }
    function addTwoPoints(lhs, rhs) {
        return { x: lhs.x + rhs.x, y: lhs.y + rhs.y };
    }
    function calcBezierY(t) {
        console.assert(t >= 0 && t <= 1, "t out of bounds");
        var erg = { x: 0, y: 0 };
        for (var i = 0; i < bezierPoints.length; i++) {
            var p = multScalarWithPoint(bezierPoints[i], binomialCoefficient(bezierPoints.length - 1, i) *
                Math.pow(1 - t, bezierPoints.length - 1 - i) *
                Math.pow(t, i));
            console.log("p ".concat(i, ":"), Math.pow(t, i), Math.pow(1 - t, bezierPoints.length - i), binomialCoefficient(bezierPoints.length, i));
            erg = addTwoPoints(p, erg);
        }
        return erg;
    }
    function onClick(clickEvent) {
        clickEvent.preventDefault();
        var x = clickEvent.clientX - canvas.offsetLeft;
        var y = clickEvent.clientY - canvas.offsetTop;
        console.log(clickEvent);
        addBezierPointAndDraw(x, y);
    }
    function onConfirm(contextMenuEvent) {
        contextMenuEvent.preventDefault();
        if (bezierPoints.length < 2)
            return;
        var previousPoint = bezierPoints[0];
        for (var t = 0; t <= 1; t += 1 / 300) {
            var point = calcBezierY(t);
            drawLineBetweenPoints(previousPoint, point, "#aaa");
            drawDot(point.x, point.y);
            previousPoint = point;
        }
        drawLineBetweenPoints(previousPoint, bezierPoints[bezierPoints.length - 1]);
        bezierPoints.splice(0); //clear Array
    }
    canvas.addEventListener("click", onClick);
    canvas.addEventListener("contextmenu", onConfirm);
    var buttonConfirm = document.createElement("button");
    buttonConfirm.innerText = "Confirm";
    buttonConfirm.onclick = onConfirm;
    document.body.append(document.createElement("br"));
    document.body.append(buttonConfirm);
})();

/******/ })()
;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LENBQUM7SUFDcEMsYUFBYSxDQUFDLE9BQU8sR0FBRyxTQUFTLENBQUM7SUFDbEMsUUFBUSxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsUUFBUSxDQUFDLGFBQWEsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDO0lBQ25ELFFBQVEsQ0FBQyxJQUFJLENBQUMsTUFBTSxDQUFDLGFBQWEsQ0FBQyxDQUFDO0FBQ3RDLENBQUMsQ0FBQyxFQUFFLENBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9iZXppZXItY3VydmUvLi9zcmMvaW5kZXgudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLy9odHRwczovL2VuLndpa2lwZWRpYS5vcmcvd2lraS9CJUMzJUE5emllcl9jdXJ2ZSNDb25zdHJ1Y3RpbmdfQiVDMyVBOXppZXJfY3VydmVzXHJcblxyXG4oKCkgPT4ge1xyXG4gIGxldCBjYW52YXMgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiY2FudmFzXCIpO1xyXG4gIGNvbnN0IHdpZHRoID0gNjQwO1xyXG4gIGNvbnN0IGhlaWdodCA9IDY0MDtcclxuXHJcbiAgY2FudmFzLndpZHRoID0gd2lkdGg7XHJcbiAgY2FudmFzLmhlaWdodCA9IGhlaWdodDtcclxuICBjb25zdCBjYW52YXNDb250ZXh0ID0gY2FudmFzLmdldENvbnRleHQoXCIyZFwiKTtcclxuICBkb2N1bWVudC5ib2R5LmFwcGVuZChjYW52YXMpO1xyXG5cclxuICBmdW5jdGlvbiBkcmF3Q2xlYXJSZWN0KCk6IHZvaWQge1xyXG4gICAgY2FudmFzQ29udGV4dC5iZWdpblBhdGgoKTtcclxuICAgIGNhbnZhc0NvbnRleHQucmVjdCgwLCAwLCB3aWR0aCwgaGVpZ2h0KTtcclxuICAgIGNhbnZhc0NvbnRleHQuZmlsbFN0eWxlID0gXCIjZWVlXCI7XHJcbiAgICBjYW52YXNDb250ZXh0LmZpbGwoKTtcclxuICAgIGNhbnZhc0NvbnRleHQuZmlsbFN0eWxlID0gXCIjMDAwXCI7XHJcbiAgICBjYW52YXNDb250ZXh0LmZvbnQgPSBcIjIwcHggQ29uc29sYXNcIjtcclxuICAgIGNhbnZhc0NvbnRleHQuZmlsbFRleHQoXCIgTGVmdCBDbGljazogU2V0IFBvaW50XCIsIDEsIDIwKTtcclxuICAgIGNhbnZhc0NvbnRleHQuZmlsbFRleHQoXCJSaWdodCBDbGljazogQ29uZmlybVwiLCAxLCA0MCk7XHJcbiAgICBjYW52YXNDb250ZXh0LmZpbGxUZXh0KFwiQsOpemllciBjdXJ2ZXNcIiwgd2lkdGggLSAxNTAsIDIwKTtcclxuICB9XHJcbiAgZHJhd0NsZWFyUmVjdCgpO1xyXG5cclxuICB0eXBlIFBvaW50ID0geyB4OiBudW1iZXI7IHk6IG51bWJlciB9O1xyXG4gIGNvbnN0IGJlemllclBvaW50czogQXJyYXk8UG9pbnQ+ID0gW107XHJcblxyXG4gIGZ1bmN0aW9uIGRyYXdEb3QoeDogbnVtYmVyLCB5OiBudW1iZXIsIGNvbG9yPzogc3RyaW5nLCByYWRpdXMgPSAxKTogdm9pZCB7XHJcbiAgICBjYW52YXNDb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgY2FudmFzQ29udGV4dC5hcmMoeCwgeSwgTWF0aC5tYXgoMSwgcmFkaXVzKSwgMCwgMiAqIE1hdGguUEkpO1xyXG4gICAgY2FudmFzQ29udGV4dC5maWxsU3R5bGUgPSBjb2xvciA/PyBcIiMwMDBcIjtcclxuICAgIGNhbnZhc0NvbnRleHQuZmlsbCgpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZHJhd0xpbmVCZXR3ZWVuUG9pbnRzKGxoczogUG9pbnQsIHJoczogUG9pbnQsIGNvbG9yPzogc3RyaW5nKTogdm9pZCB7XHJcbiAgICBjYW52YXNDb250ZXh0LmJlZ2luUGF0aCgpO1xyXG4gICAgY2FudmFzQ29udGV4dC5tb3ZlVG8obGhzLngsIGxocy55KTtcclxuICAgIGNhbnZhc0NvbnRleHQubGluZVRvKHJocy54LCByaHMueSk7XHJcbiAgICBjYW52YXNDb250ZXh0LnN0cm9rZVN0eWxlID0gY29sb3IgPz8gXCIjMDAwXCI7XHJcbiAgICBjYW52YXNDb250ZXh0LmNsb3NlUGF0aCgpO1xyXG4gICAgY2FudmFzQ29udGV4dC5zdHJva2UoKTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGFkZEJlemllclBvaW50QW5kRHJhdyh4OiBudW1iZXIsIHk6IG51bWJlcik6IHZvaWQge1xyXG4gICAgaWYgKGJlemllclBvaW50cy5sZW5ndGggPCAxKSBkcmF3Q2xlYXJSZWN0KCk7XHJcbiAgICBiZXppZXJQb2ludHMucHVzaCh7IHgsIHkgfSk7XHJcbiAgICBkcmF3RG90KHgsIHksIFwicmVkXCIsIDMpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gZmFjdG9yaWFsKG46IG51bWJlcik6IG51bWJlciB7XHJcbiAgICBpZiAobiA8IDEpIHJldHVybiAxO1xyXG4gICAgbGV0IHJldCA9IDE7XHJcbiAgICBmb3IgKGxldCBpID0gTWF0aC5mbG9vcihuKTsgaSA+IDE7IGktLSkge1xyXG4gICAgICByZXQgKj0gaTtcclxuICAgIH1cclxuICAgIHJldHVybiByZXQ7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBiaW5vbWlhbENvZWZmaWNpZW50KG46IG51bWJlciwgazogbnVtYmVyKTogbnVtYmVyIHtcclxuICAgIGNvbnNvbGUuYXNzZXJ0KFxyXG4gICAgICBrIDw9IG4gJiYgayA+PSAwLFxyXG4gICAgICBgaWxsZWdhbCBiaW5vbWlhbENvZWZmaWNpZW50ICR7bn0gb3ZlciAke2t9YFxyXG4gICAgKTtcclxuICAgIHJldHVybiBmYWN0b3JpYWwobikgLyAoZmFjdG9yaWFsKGspICogZmFjdG9yaWFsKG4gLSBrKSk7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBtdWx0U2NhbGFyV2l0aFBvaW50KHA6IFBvaW50LCBzOiBudW1iZXIpOiBQb2ludCB7XHJcbiAgICByZXR1cm4geyB4OiBwLnggKiBzLCB5OiBwLnkgKiBzIH07XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBhZGRUd29Qb2ludHMobGhzOiBQb2ludCwgcmhzOiBQb2ludCk6IFBvaW50IHtcclxuICAgIHJldHVybiB7IHg6IGxocy54ICsgcmhzLngsIHk6IGxocy55ICsgcmhzLnkgfTtcclxuICB9XHJcblxyXG4gIGZ1bmN0aW9uIGNhbGNCZXppZXJZKHQ6IG51bWJlcik6IFBvaW50IHtcclxuICAgIGNvbnNvbGUuYXNzZXJ0KHQgPj0gMCAmJiB0IDw9IDEsIFwidCBvdXQgb2YgYm91bmRzXCIpO1xyXG4gICAgbGV0IGVyZzogUG9pbnQgPSB7IHg6IDAsIHk6IDAgfTtcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgYmV6aWVyUG9pbnRzLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgIGNvbnN0IHAgPSBtdWx0U2NhbGFyV2l0aFBvaW50KFxyXG4gICAgICAgIGJlemllclBvaW50c1tpXSxcclxuICAgICAgICBiaW5vbWlhbENvZWZmaWNpZW50KGJlemllclBvaW50cy5sZW5ndGggLSAxLCBpKSAqXHJcbiAgICAgICAgICBNYXRoLnBvdygxIC0gdCwgYmV6aWVyUG9pbnRzLmxlbmd0aCAtIDEgLSBpKSAqXHJcbiAgICAgICAgICBNYXRoLnBvdyh0LCBpKVxyXG4gICAgICApO1xyXG4gICAgICBjb25zb2xlLmxvZyhcclxuICAgICAgICBgcCAke2l9OmAsXHJcbiAgICAgICAgTWF0aC5wb3codCwgaSksXHJcbiAgICAgICAgTWF0aC5wb3coMSAtIHQsIGJlemllclBvaW50cy5sZW5ndGggLSBpKSxcclxuICAgICAgICBiaW5vbWlhbENvZWZmaWNpZW50KGJlemllclBvaW50cy5sZW5ndGgsIGkpXHJcbiAgICAgICk7XHJcbiAgICAgIGVyZyA9IGFkZFR3b1BvaW50cyhwLCBlcmcpO1xyXG4gICAgfVxyXG5cclxuICAgIHJldHVybiBlcmc7XHJcbiAgfVxyXG5cclxuICBmdW5jdGlvbiBvbkNsaWNrKGNsaWNrRXZlbnQ6IE1vdXNlRXZlbnQpOiB2b2lkIHtcclxuICAgIGNsaWNrRXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGNvbnN0IHggPSBjbGlja0V2ZW50LmNsaWVudFggLSBjYW52YXMub2Zmc2V0TGVmdDtcclxuICAgIGNvbnN0IHkgPSBjbGlja0V2ZW50LmNsaWVudFkgLSBjYW52YXMub2Zmc2V0VG9wO1xyXG4gICAgY29uc29sZS5sb2coY2xpY2tFdmVudCk7XHJcblxyXG4gICAgYWRkQmV6aWVyUG9pbnRBbmREcmF3KHgsIHkpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gb25Db25maXJtKGNvbnRleHRNZW51RXZlbnQ6IE1vdXNlRXZlbnQpOiB2b2lkIHtcclxuICAgIGNvbnRleHRNZW51RXZlbnQucHJldmVudERlZmF1bHQoKTtcclxuICAgIGlmIChiZXppZXJQb2ludHMubGVuZ3RoIDwgMikgcmV0dXJuO1xyXG4gICAgbGV0IHByZXZpb3VzUG9pbnQgPSBiZXppZXJQb2ludHNbMF07XHJcbiAgICBmb3IgKGxldCB0ID0gMDsgdCA8PSAxOyB0ICs9IDEgLyAzMDApIHtcclxuICAgICAgY29uc3QgcG9pbnQgPSBjYWxjQmV6aWVyWSh0KTtcclxuICAgICAgZHJhd0xpbmVCZXR3ZWVuUG9pbnRzKHByZXZpb3VzUG9pbnQsIHBvaW50LCBcIiNhYWFcIik7XHJcbiAgICAgIGRyYXdEb3QocG9pbnQueCwgcG9pbnQueSk7XHJcbiAgICAgIHByZXZpb3VzUG9pbnQgPSBwb2ludDtcclxuICAgIH1cclxuICAgIGRyYXdMaW5lQmV0d2VlblBvaW50cyhwcmV2aW91c1BvaW50LCBiZXppZXJQb2ludHNbYmV6aWVyUG9pbnRzLmxlbmd0aCAtIDFdKTtcclxuICAgIGJlemllclBvaW50cy5zcGxpY2UoMCk7IC8vY2xlYXIgQXJyYXlcclxuICB9XHJcblxyXG4gIGNhbnZhcy5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgb25DbGljayk7XHJcbiAgY2FudmFzLmFkZEV2ZW50TGlzdGVuZXIoXCJjb250ZXh0bWVudVwiLCBvbkNvbmZpcm0pO1xyXG4gIGNvbnN0IGJ1dHRvbkNvbmZpcm0gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiYnV0dG9uXCIpO1xyXG4gIGJ1dHRvbkNvbmZpcm0uaW5uZXJUZXh0ID0gXCJDb25maXJtXCI7XHJcbiAgYnV0dG9uQ29uZmlybS5vbmNsaWNrID0gb25Db25maXJtO1xyXG4gIGRvY3VtZW50LmJvZHkuYXBwZW5kKGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJiclwiKSk7XHJcbiAgZG9jdW1lbnQuYm9keS5hcHBlbmQoYnV0dG9uQ29uZmlybSk7XHJcbn0pKCk7XHJcbiJdLCJuYW1lcyI6W10sInNvdXJjZVJvb3QiOiIifQ==